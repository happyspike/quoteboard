<link rel="import" href="../components/polymer/polymer.html">
<link rel="import" href="../components/core-ajax/core-ajax.html">
<link rel="import" href="quote-item.html">

<polymer-element name="quote-list" noscript>
  <template>
    <template repeat="{{quote in quotes}}">
      <div class="quote">
        <quote-item quote="{{quote}}"></quote-item>
      </div>
    </template>
  </template>
  <script>
    Polymer('quote-list', {
      quotes: {},
      ready: function () {
        var _this = this;
        this.updateQuotes();
        
        setInterval(function( ) {
          _this.updateQuotes();
        }, 3000);
      },
      updateQuotes: function() {
        var self = this;
        var request = new XMLHttpRequest();
        request.open('GET', '/quotes', true);

        request.onload = function() {
          if (request.status >= 200 && request.status < 400){
            self.quotes = JSON.parse(request.responseText);
          }
        };
        request.send();
      }
    });
  </script>
</polymer-element>