<link rel="import" href="../components/polymer/polymer.html">

<polymer-element name="quote-form">
  <template>
    <form on-submit="{{postQuote}}">
      <label class="visuallyhidden" for="quotefield">Quote</label>
      <div class="quotebox">
        <textarea value="{{quote.content}}" autofocus placeholder="Your mama's so fat..." >
        </textarea>
      </div>
      <div class="authorbox">
        <label for="authorfield">Author</label>
        <input type="text" value="{{quote.author}}"  />
      </div>
      <div class="submitbox">
        <button type="submit">Submit</button>
      </div>
    </form>
  </template>
  <script>
    Polymer('quote-form', {
      quote: {},
      postQuote: function(event) {
        event.preventDefault();
        event.stopPropagation();
        quoteJson = JSON.stringify(this.quote);
        
        var request = new XMLHttpRequest();
        request.open('POST', '/quotes', true);
        request.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');
        request.send(quoteJson);
        this.fire('quote-added', this.quote);
        this.quote = {};
      }
    })
  </script>
</polymer-element>